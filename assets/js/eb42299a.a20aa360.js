"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[841],{6507(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>a,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"vulnerabilities/missing-signer","title":"01 - Missing Signer","description":"Analysis","source":"@site/docs/vulnerabilities/01-missing-signer.md","sourceDirName":"vulnerabilities","slug":"/vulnerabilities/missing-signer","permalink":"/bytesUnchecked/docs/vulnerabilities/missing-signer","draft":false,"unlisted":false,"editUrl":"https://github.com/nathfavour/bytesUnchecked/tree/main/docs/docs/vulnerabilities/01-missing-signer.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"BytesUnchecked","permalink":"/bytesUnchecked/docs/intro"},"next":{"title":"02 - Arithmetic Overflow","permalink":"/bytesUnchecked/docs/vulnerabilities/arithmetic-overflow"}}');var s=i(4848),r=i(8453);const a={},c="01 - Missing Signer",o={},l=[{value:"Analysis",id:"analysis",level:2},{value:"Exploit (Insecure)",id:"exploit-insecure",level:2},{value:"The Attack",id:"the-attack",level:3},{value:"Fix (Secure)",id:"fix-secure",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"01---missing-signer",children:"01 - Missing Signer"})}),"\n",(0,s.jsx)(n.h2,{id:"analysis",children:"Analysis"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.strong,{children:"Missing Signer"})," vulnerability is the most fundamental security flaw in Solana. It occurs when a program instruction performs a privileged action (like moving funds or changing an admin) without verifying that the required authority has actually signed the transaction."]}),"\n",(0,s.jsxs)(n.p,{children:["In Solana, any account's public key can be passed into an instruction. Without an ",(0,s.jsx)(n.code,{children:"is_signer"})," check, the program assumes the caller has permission to act on behalf of that account simply because they provided its key."]}),"\n",(0,s.jsx)(n.h2,{id:"exploit-insecure",children:"Exploit (Insecure)"}),"\n",(0,s.jsxs)(n.p,{children:["In our insecure implementation, we use ",(0,s.jsx)(n.code,{children:"UncheckedAccount"})," for the admin without performing a manual signature check."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub fn update_admin_insecure(ctx: Context<UpdateAdminInsecure>, new_admin: Pubkey) -> Result<()> {\n    let state = &mut ctx.accounts.state;\n    //  Anyone can pass the admin's public key here.\n    // Since we don't check ctx.accounts.admin.is_signer, the update succeeds.\n    state.admin = new_admin;\n    Ok(())\n}\n"})}),"\n",(0,s.jsx)(n.h3,{id:"the-attack",children:"The Attack"}),"\n",(0,s.jsx)(n.p,{children:"An attacker can craft a transaction where they provide the current admin's public key but sign the transaction with their own key. Since the program never checks for the admin's signature, the state is updated to the attacker's preferred address."}),"\n",(0,s.jsx)(n.h2,{id:"fix-secure",children:"Fix (Secure)"}),"\n",(0,s.jsxs)(n.p,{children:["The fix is to use Anchor's ",(0,s.jsx)(n.code,{children:"Signer<'info>"})," type, which automatically enforces that the account signed the transaction."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-rust",children:"pub struct UpdateAdminSecure<'info> {\n    #[account(mut, has_one = admin)]\n    pub state: Account<'info, AdminState>,\n    pub admin: Signer<'info>, //  Anchor checks is_signer automatically\n}\n"})}),"\n",(0,s.jsxs)(n.p,{children:["By using ",(0,s.jsx)(n.code,{children:"Signer"}),", the program will return an error immediately if the ",(0,s.jsx)(n.code,{children:"admin"})," account is not a signer of the transaction."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,i){i.d(n,{R:()=>a,x:()=>c});var t=i(6540);const s={},r=t.createContext(s);function a(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);